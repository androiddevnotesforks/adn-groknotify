const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/luwrswtnaor2q927.js","assets/bbqge6n6s1oo3m8q.js","assets/h7m593bp4ayfx20n.js","assets/lemv4z8z7gk39eh5.js","assets/root-o5vuh9g4.css","assets/pcbzmtx4fgbka3lm.js","assets/lt2ef0v2naysiy2l.js","assets/conversation-small-iybhw0ps.css","assets/k9i239fw3jmco37f.js","assets/hkmdyhcakbcj40a3.js","assets/g4jw3x4qlzk5zulg.js","assets/d3pcjpacpv777uon.js","assets/nvlncb93a7o1rw00.js","assets/b297mz71rf8mrpuq.js","assets/o6rsu8ij68e2gpli.js","assets/o6uxxj59wwd0vs3h.js","assets/ogxj1qfz1m90i1t6.js","assets/m7kx9blkmzbaf7n6.js","assets/ez77d3328ecp9wi2.js","assets/irn9mhk2d12zm9xe.js","assets/ev8a4s0vca4ms0au.js","assets/khzh90itw6fzvwjx.js","assets/fm3vo03d03a5mwy5.js","assets/m3xepy3ohl6x8ms7.js","assets/k8pu14kekzggqjz3.js","assets/ext6yp4jkv0u79fq.js","assets/mtdnkq38qtvvzisx.js","assets/j16ybgcf5bpskcog.js","assets/mdwe0klwm30isq25.js","assets/mvdk1xvwj4qupms6.js","assets/kox23klzui1hhel0.js","assets/j1ditdbor1tznbcv.js"])))=>i.map(i=>d[i]);
import{ap as I,ar as J,gq as Q,f3 as ae,f4 as ne,bf as te,dU as oe,f0 as ie,dT as re,b9 as K,bj as $,j as L,bs as le,gr as ce,V as me,P as de,aO as v,aP as b,aQ as ge,d3 as fe,ad as O,eM as _e}from"./lemv4z8z7gk39eh5.js";import{r as u,j as s,ad as P,ac as R,M}from"./bbqge6n6s1oo3m8q.js";import{f_ as F,f$ as Y,g0 as ue,g1 as xe,g2 as pe,g3 as he,g4 as Ee,$ as ye,_ as ve,g5 as be,F as je,g6 as Te,g7 as Ie,g8 as Ae,c2 as n,g9 as Se,ga as Ne,gb as we,gc as Re,gd as De,ge as Ce,gf as Pe,gg as Oe,fw as Le}from"./lt2ef0v2naysiy2l.js";import{N as Me}from"./k9i239fw3jmco37f.js";const ke=2e3,X=.4,Ve=.45,Fe=.2,Ue=.1,Be=.25;var N=(e=>(e[e.Running=0]="Running",e[e.Finished=1]="Finished",e[e.Error=2]="Error",e[e.Stopped=3]="Stopped",e[e.Paused=4]="Paused",e))(N||{});function xs({conversationMessages:e,icon:o,status:a,text:f,estimatedToolDurationMs:x,animationLoopDurationMs:g=ke,shouldPersistAfterFinished:r=!1}){const[m,i]=u.useState(a===0?0:a===1&&!r?7:1),[c,p]=u.useState(0);u.useEffect(()=>{a===2?i(8):a===3?i(9):a===4?i(10):a===1?i(m===2?3:7):a===0&&m===10&&(i(2),p(l=>l+1))},[a]);const d=He(m);return u.useEffect(()=>{const l=e[0].message.id;if(d)return F.addDelayedRenderingMessage(l),()=>{F.removeDelayedRenderingMessage(l)}},[d]),Y(()=>{w(m)&&p(l=>l+1)},g),m===7&&!r?null:s.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[s.jsx(ze,{icon:o,status:a,uiState:m,estimatedToolDurationMs:x,animationLoopCounter:c,shouldPersistAfterFinished:r,onFillProgressBarAnimationComplete:()=>i(4),onFinishAnimationComplete:()=>{i(5),setTimeout(()=>{i(r?7:6)},Ue*1e3)},onHideAnimationComplete:()=>i(7)}),s.jsx(We,{text:f,uiState:m,animationLoopCounter:c,onEnterAnimationComplete:()=>i(2)})]})}const U=50;function ze({icon:e,status:o,uiState:a,estimatedToolDurationMs:f,animationLoopCounter:x,shouldPersistAfterFinished:g,onFillProgressBarAnimationComplete:r,onFinishAnimationComplete:m,onHideAnimationComplete:i}){const[c,p]=u.useState(0);Y(()=>{w(a)?p(C=>C+U):a===10&&p(0)},U);let d,l,h;w(a)||a===10?(d="running",l=s.jsx(e,{animationLoopCounter:x}),h="bg-transparent"):a===4||a===5||a===7&&g?(d="finished",l=s.jsx(xe,{}),h="bg-brand-purple"):o===2?(d="error",l=s.jsx(pe,{}),h="bg-orange-500"):o===3&&(d="stopped",l=s.jsx(he,{}),h="bg-gray-300");let y={opacity:0,scale:0,rotate:-180,x:0},j={type:"spring",bounce:.3,duration:Ve},A={opacity:0,scale:.6,rotate:0,x:0};a===0?(y={opacity:0,scale:.5,rotate:-180,x:-8},j={type:"spring",bounce:.3,duration:X}):a===1?y=!1:a===5&&(A={opacity:0,scale:0,rotate:0,x:0},j={type:"spring",bounce:.3,duration:Be});const D=Ee(c,f);return s.jsx("div",{className:"relative h-5 w-5 shrink-0",children:s.jsx(P,{onExitComplete:()=>{a===6&&i()},children:d!=null&&s.jsxs(R.div,{className:I("absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full text-white",h),initial:y,animate:{opacity:1,scale:1,rotate:0,x:0},exit:A,transition:j,onAnimationComplete:()=>{a===4&&m()},children:[l,(w(a)||a===10)&&s.jsx(ue,{percentage:a===3?100:D,thickness:1.5/23,className:"absolute left-1/2 top-1/2 h-[23px] w-[23px] -translate-x-1/2 -translate-y-1/2 text-brand-purple",backgroundStrokeClassName:"stroke-brand-purple/25 dark:stroke-brand-purple/50",transitionDuration:a===3?`${(100-D)/100*Fe}s`:void 0,transitionTimingFunction:a===3?"cubic-bezier(0.55, 0, 1, 1)":void 0,onTransitionEnd:()=>{a===3&&r()}})]},d)})})}function We({text:e,uiState:o,animationLoopCounter:a,onEnterAnimationComplete:f}){const[x,g]=u.useState(e);u.useEffect(()=>{o===2&&g(e)},[a]),u.useEffect(()=>{w(o)||g(e)},[o,e]);let r={opacity:0,x:0,y:15},m={type:"spring",bounce:.3,opacity:{duration:.15},y:{duration:.3}};o===0?(r={opacity:0,x:-8,y:0},m={type:"spring",bounce:.3,duration:X,delay:.15}):o===1&&(r=!1);const i=x??void 0;return s.jsx("div",{className:I("relative h-5 w-full leading-5",o===8||o===9?"text-token-text-tertiary":"text-token-text-secondary"),children:s.jsx(P,{children:i!=null&&s.jsx(R.div,{className:"absolute left-0 top-0 line-clamp-1 overflow-visible",initial:r,animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:0,y:-15},transition:m,onAnimationComplete:()=>{o===0&&f()},children:i},i.toString())})})}function w(e){return e===0||e===2||e===3}function He(e){return w(e)||e===4||e===5||e===6||e===10}const B=J.div`group absolute left-0 top-0 mr-1.5 h-8 overflow-hidden mt-1`;function Je({highlightedCommand:e,status:o,children:a,showWorkUserSetting:f=!1,hideOnlyIfNotInteractedWith:x=!1,onOpenAnalytics:g,onClick:r}){const m=a!=null||r!=null,[i]=u.useState(f),[c,p]=u.useState(f),[d,l]=u.useState(!1),h=o===N.Finished||o===N.Error,y=x?i?!1:!d:!1,j=o===N.Running&&"loading-shimmer";return h&&y?null:m?s.jsxs(s.Fragment,{children:[s.jsx(z,{$canShowWork:!0,children:s.jsx(P,{children:s.jsx(B,{children:s.jsx(R.button,{onClick:()=>{c||g?.(),p(A=>!A),l(!0),r?.()},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:I(j),children:s.jsxs("div",{className:"flex items-center justify-start gap-1",children:[s.jsx("span",{children:e}),!r&&(c?s.jsx(ye,{className:"icon-md"}):s.jsx(ve,{className:"icon-md"}))]})},e?.toString())})})}),s.jsx(P,{children:c&&a&&s.jsx(R.div,{initial:"collapsed",animate:"reveal",exit:"collapsed",variants:{collapsed:{translateY:-20,opacity:0,height:0},reveal:{translateY:0,opacity:1,height:"auto"}},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:a})})]}):s.jsx(z,{$canShowWork:!1,children:s.jsx(B,{className:I(j),children:e})})}const z=J.span`block first:mt-0 relative h-8
${({$canShowWork:e})=>e?"text-token-text-secondary hover:text-token-text-primary my-1.5":"text-token-text-secondary"}`,Qe=3,Ke=.1,W=[0,.26,.4];function $e({nextMessage:e,isLastMessage:o,isRequestActive:a,isLastTurnInConversation:f,clientThreadId:x,turnIndex:g}){let r=o||!e||e&&!Q(e.message);const m=ae(e?.message),i=ne(e?.message);e?.message.id&&be(e?.message.id);const c=[];if(i?.[0]?.type==="navigation"&&e&&c.push(s.jsx(Ye,{clientThreadId:x,turnIndex:g,nextMessage:e,isRequestActive:a,isLastTurnInConversation:f,navigationCitation:i[0]},"fast-nav")),r){const p=te(m.slice(0,Qe).map(l=>l.entries[0].url)),d=a?s.jsxs("div",{className:"flex items-center gap-1",children:[p.map((l,h)=>s.jsx(R.div,{className:I("-ml-1.5 first:ml-0 last:mr-1.5","relative"),initial:{width:h===0?0:6,opacity:0},animate:{width:20,opacity:1},transition:{duration:Ke,delay:W[Math.min(h,W.length-1)]},children:s.jsx("div",{className:I("flex h-[22px] w-[22px] items-center overflow-hidden rounded-full","border-2 border-token-main-surface-primary bg-token-main-surface-primary"),children:s.jsx(je,{url:l,size:32,minSize:16,className:"icon-md rounded-full"})})},l)),s.jsx(M,{id:"jjx8Qg",defaultMessage:"Searching the web"})]}):s.jsx(M,{id:"fssXGM",defaultMessage:"Error while searching"});c.push(s.jsx(Je,{highlightedCommand:d,status:a?N.Running:N.Error},"search-gpt-query"))}return c.length?s.jsx(s.Fragment,{children:c}):null}const Ye=({clientThreadId:e,turnIndex:o,nextMessage:a,isRequestActive:f,isLastTurnInConversation:x,navigationCitation:g})=>{const{scrollToHeader:r}=oe("searchSources")??{},m=ie(),i=re()&&m?.type==="searchSources",{openThreadSidebar:c}=K(),{value:p}=$("756982148");return u.useEffect(()=>{i&&c({type:"searchSources",scrollToHeader:r,clientThreadId:e,turnIndex:o,messageId:a?.message.id??""})},[]),u.useEffect(()=>{const d=a.message,l=d.metadata?.search_source,h=g.domains.map(y=>y.url);Te.logEvent(L.searchToolRequestTimeToFastNav,e,d.id,{search_source:l,urls:h},()=>{l===le.InstantQuery&&Ie.logEvent(L.searchToolPageLoadTimeToFastNav,{message_id:d.id,urls:h,search_source:l})})},[e,a,g]),f&&x&&p?s.jsx(R.div,{initial:{opacity:f?0:1,height:f?0:"auto"},animate:{opacity:1,height:"auto"},children:s.jsx(H,{clientThreadId:e,turnIndex:o,nextMessage:a,navigationCitation:g})}):s.jsx(H,{clientThreadId:e,turnIndex:o,nextMessage:a,navigationCitation:g})},H=({clientThreadId:e,turnIndex:o,nextMessage:a,navigationCitation:f})=>{const{toggleThreadSidebar:x}=K(),{value:g}=$("756982148"),r=u.useMemo(()=>({clientThreadId:e,turnIndex:o,messageId:a?.message.id}),[e,o,a?.message.id]),m=u.useCallback((p,d)=>{x({type:"searchSources",scrollToHeader:d,clientThreadId:e,turnIndex:o,messageId:a?.message.id??""})},[x,e,o,a?.message.id]),i=u.useRef(!1),c=u.useCallback((p,d,l,h)=>{if(r&&r.messageId&&ce(r.messageId)&&(!i.current||p!==L.searchContentReferenceShown)){i.current=!0;const y={...me(r),type:l,index:0,...h??{}};de.logEventWithStatsig(p,d,y)}},[r]);return g?s.jsx(Me,{navigation:f,onShowSearchResults:m,trackContentReferenceEvent:c}):s.jsx(Ae,{tldr:{type:"tldr",display_title:f.domains[0].title,url:f.domains[0].url,matched_text:"",start_idx:0,end_idx:0,page_title:"",breadcrumbs:[f.domains[0].domain]},trackContentReferenceEvent:c})},Xe=v(()=>b(()=>import("./luwrswtnaor2q927.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),Ze=v(()=>b(()=>import("./hkmdyhcakbcj40a3.js"),__vite__mapDeps([9,1,3,4,10]))),qe=v(()=>b(()=>import("./d3pcjpacpv777uon.js"),__vite__mapDeps([11,1,3,4,6,7]))),Ge=v(()=>b(()=>import("./nvlncb93a7o1rw00.js"),__vite__mapDeps([12,1,3,4,6,7])).then(e=>e.TextMessageEditor)),es=v(()=>b(()=>import("./b297mz71rf8mrpuq.js"),__vite__mapDeps([13,1,3,4,14,6,7,15,2,5,16,17,8]))),ss=v(async()=>()=>null),as=v(()=>b(()=>import("./ez77d3328ecp9wi2.js"),__vite__mapDeps([18,1,3,4,6,7,8]))),ns=v(()=>b(()=>import("./irn9mhk2d12zm9xe.js"),__vite__mapDeps([19,1,3,4,6,7,20,8])).then(e=>e.BrowsingMessage)),ts=v(()=>b(()=>import("./khzh90itw6fzvwjx.js"),__vite__mapDeps([21,1,3,4,6,7])).then(e=>e.SearchResultMessage)),os=v(()=>b(()=>import("./fm3vo03d03a5mwy5.js"),__vite__mapDeps([22,1,3,4,6,7,8])).then(e=>e.JITPluginMessage)),is=v(()=>b(()=>import("./m3xepy3ohl6x8ms7.js"),__vite__mapDeps([23,3,1,4,6,7,8])).then(e=>e.DataAnalysisMessage)),rs=v(()=>b(()=>import("./k8pu14kekzggqjz3.js"),__vite__mapDeps([24,1,3,4,16,6,7,25,26,8]))),ls=v(()=>b(()=>import("./j16ybgcf5bpskcog.js"),__vite__mapDeps([27,1,6,3,4,7,28,29,30,31])).then(e=>e.JawboneMessage));function ps(e){switch(e.type){case n.Text:case n.Debug:return[e.message];case n.MultiText:case n.Browsing:case n.CodeInterpreter:case n.JITPlugin:case n.RetrievalBrowsing:case n.ParallelBrowsing:case n.Dalle:case n.GizmoEditor:case n.SearchResult:case n.a8km123:case n.f959b8c:case n.b1de6e2:case n.b1de6e2_c:case n.b1de6e2_s:case n.is_loading_message:case n.Canmore:case n.SonicCanvas:case n.de1d73e:case n.SearchGPTQuery:case n.oiw209h:return e.messages;default:throw new Error("Bad")}}function hs({groupedMessagesToRender:e,allGroupedMessages:o,clientThreadId:a,isEditing:f,isUserTurn:x,isCompletionRequestInProgress:g,isFeedbackEnabled:r,isFinalTurn:m,turnIndex:i,hasActiveRequest:c,showEditButton:p=!1,handleEnterEdit:d,handleExitEdit:l,onChangeItemInView:h,onRequestMoreCompletions:y,onRequestCompletion:j,shouldGrowContainer:A=!0}){const{showDebugConversationTurns:D}=Se(),C=ge(a),k=fe(a),Z=Ne(),q=o.some(t=>we.includes(t.type));o.some(t=>t.type===n.b1de6e2_s);const G=e.map((t,_)=>{const T=_===o.length-1;switch(t.type){case n.Text:case n.MultiText:{const E=e[_-1],S=E?.type,V=E&&"messages"in E?E.messages:void 0;if(t.type===n.Text){const ee=t?.message&&!Q(t.message.message),se=f?s.jsx(Ge,{message:t.message,clientThreadId:a,onChangeItemInView:h,onRequestCompletion:j,onRequestMoreCompletions:y,onExitEdit:l,disabled:c}):q&&ee?null:s.jsx(Pe,{className:"min-h-8",message:t.message,isFeedbackEnabled:r,isCompletionInProgress:T&&g,turnIndex:i,clientThreadId:a,showEditButton:p,onEnterEdit:d,isUserTurn:x,onRequestMoreCompletions:y,prevGroupedMessageType:S,prevGroupedMessages:V});return s.jsxs(u.Fragment,{children:[se,s.jsx(Oe,{isUserTurn:x,message:t.message.message})]},"group-"+t.message.nodeId)}else return t.type===n.MultiText?s.jsx(qe,{clientThreadId:a,messages:t.messages,isCompletionInProgress:T&&g,isFeedbackEnabled:r,onRequestMoreCompletions:y,prevGroupedMessageType:S,prevGroupedMessages:V},"multitext-"+(t.messages[0]?.nodeId??_)):t.type}case n.Browsing:case n.RetrievalBrowsing:{const E=C!=null&&[O.GizmoInteraction,O.GizmoMagicCreate,O.GizmoTest].includes(C.kind),S=k?Ce(k):!1;return s.jsx(ns,{messages:t.messages,isRequestActive:c,isLastMessageInTurn:T,isUsingGizmo:E,isUsingSnorlax:S,isRetrieval:t.type===n.RetrievalBrowsing},"browsing-"+(t.messages[0]?.nodeId??_))}case n.SearchGPTQuery:{const E=o.slice(_+1).find(S=>S.type===n.Text);return s.jsx($e,{clientThreadId:a,turnIndex:i,isRequestActive:c,isLastMessage:T,isLastTurnInConversation:m,nextMessage:E&&E.type===n.Text?E.message:void 0},"searchquery-"+(t.messages[0]?.nodeId??_))}case n.a8km123:return s.jsx(rs,{messages:t.messages,isStreaming:T&&g,isLastMessage:T,clientThreadId:a,currentGroupedMessageIndex:_,turnIndex:i},"sum-"+(t.messages[0]?.nodeId??_));case n.f959b8c:return null;case n.is_loading_message:return T&&g?s.jsx(De,{}):null;case n.b1de6e2:return null;case n.b1de6e2_c:return null;case n.b1de6e2_s:return null;case n.de1d73e:if(Z){const E=_+1<o.length?o[_+1]:void 0;return s.jsx(ls,{clientThreadId:a,currentGroupedMessage:t,nextMessage:E&&E.type===n.Text?E.message:void 0,isLastMessage:T,isRequestActive:c},"jawbone-"+(t.messages[0]?.nodeId??_))}else return null;case n.ParallelBrowsing:return s.jsx(as,{messages:t.messages},"parallel-"+(t.messages[0]?.nodeId??_));case n.CodeInterpreter:return s.jsx(is,{messages:t.messages,isRequestActive:c,clientThreadId:a},"ada-"+(t.messages[0]?.nodeId??_));case n.JITPlugin:return s.jsx(os,{messages:t.messages,clientThreadId:a,isLastTurnInConversation:m,onRequestCompletion:j},"jit-"+(t.messages[0]?.nodeId??_));case n.Dalle:return s.jsx(es,{messages:t.messages,clientThreadId:a},"dalle-"+(t.messages[0]?.nodeId??_));case n.GizmoEditor:return s.jsx(Xe,{messages:t.messages},"gizmo-editor-"+(t.messages[0]?.nodeId??_));case n.oiw209h:return s.jsx(ss,{messages:t.messages,clientThreadId:a},"oiw209h-"+(t.messages[0]?.nodeId??_));case n.Canmore:return s.jsx(Re,{messages:t.messages,allGroupedMessages:e,isFinalTurn:m,isRequestActive:c,clientThreadId:a},"canmore-"+(t.messages[0]?.nodeId??_));case n.SonicCanvas:return!1;case n.Debug:return D?s.jsx(Ze,{message:t.message},"debug-"+t.message.nodeId):null;case n.SearchResult:return s.jsx(ts,{messages:t.messages},"search-result-"+(t.messages[0]?.nodeId??_))}});return s.jsx(ms,{shouldGrowContainer:A,children:G})}function cs(){return s.jsx(Le,{type:"danger",children:s.jsx(M,{id:"5eGo3w",defaultMessage:"Unable to display this message due to an error."})})}function ms({children:e,shouldGrowContainer:o}){return s.jsx("div",{className:I({"flex max-w-full flex-col":!0,"flex-grow":o}),children:s.jsx(_e,{name:"GroupedMessages",fallback:cs,children:e})})}export{hs as C,N as T,Je as a,xs as b,ps as g};
//# sourceMappingURL=pah0un9d5vytizt6.js.map
